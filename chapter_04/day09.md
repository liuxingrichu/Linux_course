#### 监视进程之ps和pstree ####
命令ps输出的只是当前查询状态下，进程瞬间的状态信息。

若想及时动态地查看进程就需要使用top命令了。

top命令提供了实时的系统状态监控，可以按照CPU使用、内存使用、执行时间等指标对进程进程排序。

1. ps（process status）命令
	1. 语法：ps  [选项]
	2. 功能：显示系统中进程的信息。
	3. 其包括进程ID、控制进程终端、执行时间和命令。
	4. 选项不同，可显示全部或部分进程。
	5. 无选项时，只列出从当前终端上启动的进程或当前用户的进程。

			选项：
				-a 显示与终端有关的所有进程，同时除session leader;
				-A 显示所有进程;
				-e 此参数的效果和指定"A"参数相同，显示所有进程;
				-f 全部列出，通常和其他选项联用，做一个更为完整的输出。
				-l  较长、较详细的将该 PID的信息列出；
				-x 通常与a这个参数一起使用，可列出较完整信息；
				-u  指定用户的所有进程
				-o 用户自定义格式

				进程是按照进程组管理的，进程组又属于session。关系如下：
				每个session拥有一个或者多个进程组，每个进程组拥有一个或多个进程。第一个属于某个session的进程id就是这个session的 leader， session id就用它的进程id。
				Session ID (SID)
				
				This is just the PID of the session leader. If PID == SID, then this process is a session leader.

			仅查看自己的bash相关进程
			$ ps -l
		
				F 代表这个进程标志，说明这个进程的权限，常用号码有：
					若为4，表示此进程的权限为 root。
					若为1，表示此子进程仅可进行复制，而无法实际执行。
				S 代表这个程序的状态 (STAT)；
				UID 代表执行者身份
				PID 进程的ID号！
				PPID 父进程的ID；
				C CPU使用的资源百分比
				PRI指进程的执行优先权(Priority的简写)，其值越小越早被执行；
				NI 这个进程的nice值，其表示进程可被执行的优先级的修正数值。
				ADDR 这个是内核函数，指出该程序在内存的那个部分。如果是个执行 的程序，一般就是『 - 』
				SZ 使用掉的内存大小；
				WCHAN 目前这个程序是否正在运作当中，若为 - 表示正在运作；
				TTY 登入者的终端机位置；
				TIME 使用掉的 CPU 时间。
				CMD 所下达的指令名称


			查看系统所有进程
			$ ps aux 
			
				USER：该进程属于那个使用者账号。
				PID ：该进程的进程ID号。
				%CPU：该进程使用掉的 CPU 资源百分比；
				%MEM：该进程所占用的物理内存百分比；
				VSZ ：该进程使用掉的虚拟内存量 (Kbytes)
				RSS ：该进程占用的固定的内存量 (Kbytes)
				TTY ：该进程是在那个终端机上面运作，若与终端机无关，则显示 ?。另外， tty1-tty6 是本机上面的登入者程序，若为 pts/0 等等的，则表示为由网络连接进主机的程序。
				STAT：该程序目前的状态，主要的状态有：
					R ：该程序目前正在运作，或者是可被运作；
					S ：该程序目前正在睡眠当中，但可被某些讯号(signal) 唤醒。
					T ：该程序目前正在侦测或者是停止了；
					Z ：该程序应该已经终止，但是其父程序却无法正常的终止他，造成 zombie (疆尸) 程序的状态
				START：该进程被触发启动的时间；
				TIME ：该进程实际使用 CPU 运作的时间。
				COMMAND：该程序的实际指令。


			程序运行状态解析
			ps aux命令显示的状态列中的Ss+，Rsl，R+，S<sl的含义：
			
			    D    不可中断     Uninterruptible sleep (usually IO)
			    R    正在运行，或在队列中的进程
			    S    处于休眠状态
			    T    停止或被追踪
			    Z    僵尸进程
			    W    进入内存交换（从内核2.6开始无效）
			    X    死掉的进程
			
			    <    高优先级
			    N    低优先级
			    L    有些页被锁进内存
			    s    包含子进程
			    +    位于后台的进程组；
			    l    多线程，克隆线程  multi-threaded (using CLONE_THREAD, like NPTL pthreads do)

			通常，造成僵尸进程的成因是因为进程应该已执行完毕，或者是因故应该要终止了，但是该进程的父进程却无法完成将该进程结束掉，而造成那个进程一直存在内存当中。

			若发现系统中存在很多僵尸进程时，要找到该进程的父进程，然后好好跟踪，好好进行主机的环境优化。

			ps aux 是用BSD的格式来显示进程
			显示的项目有：USER , PID , %CPU , %MEM , VSZ , RSS , TTY , STAT , START , TIME , COMMAND
			
			ps -ef 是用标准的格式显示进程
			显示的项目有：UID , PID , PPID , C , STIME , TTY , TIME , CMD

			请注意"ps -aux"不同于"ps aux"。POSIX和UNIX的标准要求"ps -aux"打印用户名为"x"的用户的所有进程，以及打印所有将由-a选项选择的过程。如果用户名为"x"不存在，ps的将会解释为"ps aux"，而且会打印一个警告。这种行为是为了帮助转换旧脚本和习惯。它是脆弱的，即将更改，因此不应依赖。


			$ ps -ef 全格式输出所有进程
			    UID       用户ID
				PID       进程ID
				PPID      父进程ID
				C         CPU占用率
				STIME     开始时间
				TTY       开始此进程的TTY----终端设备
				TIME      此进程运行的总时间
				CMD       命令名

			用户自定义格式输出
				ps -o pid,stat,pri,uid|head -n 3
				不输出提示行（第一行）
				ps -o pid= -o stat= -o uid=
				ps -eo pid= -o stat= -o uid=
				按照uid排序
				ps -eo pid,stat,pri,uid --sort uid|tail


2. pstree命令
	1. 语法： pstree [选项]
	2. 功能：以树状方式表现进程的父子关系。
	3. 用ASCII字符显示树状结构，清楚地表达进程间的相互关系。
	4. 如果不指定进程识别码或用户名称，则会把系统启动时的第一个进程（init）视为根，并显示之后的所用进程。
	5. 若指定用户名称，会已属于该用户的第一个进程当成根，然后显示该用户的所用进程。
	
			安装方法
			yum install psmisc
			
			查看PID为1234的进程及其子进程
			$ pstree -cp 1234

			选项
				-a：显示每个程序的完整指令，包含路径，参数或是常驻服务的标示；
				-c：不使用精简标示法；
				-G：使用VT100终端机的列绘图字符；
				-h：列出树状图时，特别标明现在执行的程序；
				-H<程序识别码>：此参数的效果和指定"-h"参数类似，但特别标明指定的程序；
				-l：采用长列格式显示树状图；
				-n：用程序识别码排序。预设是以程序名称来排序；
				-p：显示程序识别码；
				-u：显示用户名称；
				-U：使用UTF-8列绘图字符；
				-V：显示版本信息。





